{% extends "base.html" %}

{% block content %}
  {% for video in videos %}
    <div class="video-card">
      <h3>{{ video.title }}</h3>
      {% if "embed" in video.url or "facebook.com/plugins/video.php" in video.url or "player.vimeo.com/video" in video.url %}
        <iframe width="100%" height="315"
                src="{{ video.url }}"
                frameborder="0"
                allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture"
                allowfullscreen>
        </iframe>
      {% else %}
        <video controls width="100%">
          <source src="{{ video.url }}" type="video/mp4">
          Your browser does not support HTML5 video.
        </video>
      {% endif %}
      <p>Thể loại: {{ video.category }}</p>
      <p>👍 {{ video.likes }}   👎 {{ video.dislikes }}</p>
      <a href="/like/{{ loop.index0 }}">Like</a> |
      <a href="/dislike/{{ loop.index0 }}">Dislike</a>

      <h4>Bình luận:</h4>
      <form action="/comment/{{ loop.index0 }}" method="POST">
        <input type="text" name="comment" placeholder="Viết bình luận...">
        <button type="submit">Gửi</button>
      </form>

      <ul>
        {% for c in video.comments %}
          <li>{{ c }}</li>
        {% endfor %}
      </ul>

      {% if user and user.role == 'admin' %}
        <a href="/delete/{{ loop.index0 }}">🗑️ Xóa video</a>
      {% endif %}
      <hr>
    </div>
  {% endfor %}
{% endblock %}
