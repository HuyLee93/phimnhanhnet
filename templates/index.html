{% extends "base.html" %}
{% block content %}
<header>
  <img src="{{ url_for('static', filename='images/logo.png') }}" class="logo">
  <h1>Phimnhanh.net â€“ Vá»«a nhanh vá»«a nÃ©t</h1>
  <nav>
    {% if session.get('admin') %}
    <a href="{{ url_for('upload') }}">Upload</a>
    <a href="{{ url_for('logout') }}">ÄÄƒng xuáº¥t</a>
    {% else %}
    <a href="{{ url_for('login') }}">ÄÄƒng nháº­p</a>
    {% endif %}
  </nav>
</header>

<form method="GET" action="{{ url_for('home') }}" class="search-filter">
  <input type="text" name="q" placeholder="TÃ¬m video..." value="{{ request.args.get('q', '') }}">
  <select name="category">
    <option value="">-- Táº¥t cáº£ thá»ƒ loáº¡i --</option>
    <option value="HÃ i" {% if request.args.get('category') == 'HÃ i' %}selected{% endif %}>HÃ i</option>
    <option value="HÃ nh Ä‘á»™ng" {% if request.args.get('category') == 'HÃ nh Ä‘á»™ng' %}selected{% endif %}>HÃ nh Ä‘á»™ng</option>
    <option value="Hoáº¡t hÃ¬nh" {% if request.args.get('category') == 'Hoáº¡t hÃ¬nh' %}selected{% endif %}>Hoáº¡t hÃ¬nh</option>
    <option value="áº¢nh" {% if request.args.get('category') == 'áº¢nh' %}selected{% endif %}>áº¢nh</option>
  </select>
  <button type="submit">TÃ¬m</button>
</form>

<main>
  {% for video in videos %}
  <div class="video-card">
    <h3>{{ video.title }} <small style="font-weight: normal; color: #999">({{ video.category }})</small></h3>

    {% if video.file %}
    <video controls width="100%">
      <source src="/{{ video.file }}" type="video/mp4">
    </video>
    {% elif video.url %}
    <iframe width="100%" height="315" src="{{ video.url }}" frameborder="0" allowfullscreen></iframe>
    {% endif %}

    <form method="POST" action="{{ url_for('comment', video_id=loop.index0) }}">
      <input type="text" name="comment" placeholder="Nháº­p bÃ¬nh luáº­n...">
      <button type="submit">BÃ¬nh luáº­n</button>
    </form>

    <p><a href="{{ url_for('like', video_id=loop.index0) }}">ğŸ‘ ThÃ­ch</a> ({{ likes.get(loop.index0, 0) }})</p>

    <ul class="comments">
      {% for cmt in comments.get(loop.index0, []) %}
      <li>{{ cmt }}</li>
      {% endfor %}
    </ul>
  </div>
  {% else %}
  <p>ChÆ°a cÃ³ video nÃ o.</p>
  {% endfor %}
</main>
{% endblock %}
